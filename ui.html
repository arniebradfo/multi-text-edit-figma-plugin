<main id="root">
  <textarea id="textArea" ></textarea>
  <div id="bottomBar">
    <button id="editButton">Edit Text</button>
    <button id="pullButton">Pull Text</button>
    <div class="flexSplit"></div>
    <div id="resizeHandle">drag</div>
  </div>
</main>

<style>
#root, html, body{
  height: 100%;
  width: 100%;
  padding: 0;
  margin: 0;
}
#root{
  display: flex;
  overflow: hidden;
  flex-direction: column;
}
#bottomBar{
  display: flex;
}
.flexSplit{
  flex: 1 1 auto;
}
#textArea {
  flex: 1 1 auto;
}
</style>

<script>

  const textArea = document.getElementById('textArea')
  const editButton = document.getElementById('editButton')
  const pullButton = document.getElementById('pullButton')
  const resizeHandle = document.getElementById('resizeHandle')

  editButton.onclick = () => {
    parent.postMessage({ pluginMessage: { type: 'editText', value: textArea.value } }, '*')
  }

  pullButton.onclick = () => {
    parent.postMessage({ pluginMessage: { type: 'pullText' } }, '*')
  }

  resizeHandle.addEventListener("mousedown", (e) => {
    e.preventDefault();

    const startX = e.clientX;
    const startY = e.clientY;

    function onMouseMove(e) {
      const x = e.clientX - startX;
      const y = e.clientY - startY;

      parent.postMessage({ pluginMessage: { type: 'resizeWindow', dimensions: { x, y } } }, '*')
    }

    function onMouseUp() {
      document.removeEventListener("mousemove", onMouseMove);
      document.removeEventListener("mouseup", onMouseUp);
      parent.postMessage({ pluginMessage: { type: 'endResizeWindow' } }, '*')

    }

    document.addEventListener("mousemove", onMouseMove);
    document.addEventListener("mouseup", onMouseUp);
  });

  onmessage = (event) => {
    // console.log(event);

    textArea.value = event.data.pluginMessage || 'broken'
    // console.log("got this from the plugin code", event.data.pluginMessage)
  }

</script>